# ArxConverter

Инструмент командной строки для чтения, парсинга и экспорта 3D-моделей из формата `.ftl`

---

## Возможности

- Чтение и декомпрессия `.ftl`-файлов (формат ArxExplode)
- Парсинг бинарных данных: вершины, полигоны, группы вершин, текстурные пути, action points, collision spheres, progressive mesh, cloth-симуляция
- Экспорт данных в несколько форматов:
  - **JSON**
  - **XML**
  - **OBJ + MTL**
  - **glTF**

---

## Требования

- Компилятор с поддержкой **C++23**
- Рекомендуется: MSVC 19.35+ или Clang 17+
- Linux: не тестировалось

## Использование

```
ArxConverter.exe <file.ftl> [output_directory]
```

| Аргумент           | Описание                                                                 |
|--------------------|--------------------------------------------------------------------------|
| `<file.ftl>`       | Путь к входному `.ftl`-файлу (обязательный)                             |
| `[output_directory]` | Директория для сохранения результатов (необязательный). По умолчанию — папка рядом с входным файлом |

### Примеры

```bash
# Экспорт рядом с исходным файлом
ArxConverter.exe models/goblin.ftl

# Экспорт в указанную директорию
ArxConverter.exe models/goblin.ftl C:\Export
```

В обоих случаях будет создана поддиректория с именем, совпадающим со стемом входного файла (например, `goblin/`), внутри которой появятся экспортированные файлы.

---

## Структура проекта

| Файл                  | Описание                                                              |
|-----------------------|-----------------------------------------------------------------------|
| `ArxConverter.ixx/.cpp` | Оркестратор: разбирает аргументы, создаёт выходную директорию, координирует работу компонентов |
| `ArxFile.ixx/.cpp`    | Читает `.ftl`-файл с диска и декомпрессирует его через `ArxExplode`  |
| `ArxParser.ixx/.cpp`  | Парсит бинарные данные декомпрессированного файла в структуры        |
| `ArxExporter.ixx/.cpp`| Экспортирует распарсенные данные в JSON, XML, OBJ/MTL и glTF         |

---

## Формат FTL

FTL-файл содержит:

- **Первичный заголовок** — сигнатура `FTL` и версия формата
- **Вторичный заголовок** — смещения до секций: 3D-данные, collision spheres, progressive mesh, cloth-данные
- **3D-данные** — вершины, полигоны, текстурные пути (256 байт на путь), группы вершин, action points, выборки вершин
- **Collision Spheres** — сферы для физики столкновений
- **Progressive Mesh** — данные для LOD-системы
- **Cloth Data** — вершины и пружины для симуляции ткани

Более подробное описание всего: **ArxHeaders.ixx**

---